<?xml version="1.0" encoding="UTF-8" ?>
<ui:composition template="/resources/templates/template.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:comp="http://java.sun.com/jsf/composite/components"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ice="http://www.icesoft.com/icefaces/component"
	xmlns:idm="http://midpoint.evolveum.com/xml/ns/custom-taglib/">

	<ui:define name="title">#{msg['page.server.index.title']}</ui:define>

	<ui:define name="menu">
		<ui:include src="./menu.xhtml" />
	</ui:define>

	<ui:define name="content">
		<ice:form>
			<div class="button-bar">

				<idm:button value="Edit task" img="/resources/images/drive_burn.png"
					id="editTask" immediate="true"
					action="#{taskDetails.editPerformed}"
					rendered="#{not taskDetails.editMode}" />

			</div>
			<ice:panelGroup>
				<ice:panelGrid columns="2" cellpadding="7" cellspacing="7">
					<f:facet name="header">
						<h3>Task</h3>
					</f:facet>
					<ice:outputLabel value="Task oid: " />
					<ice:outputText value="#{taskDetails.task.oid}" />

					<ice:outputLabel value="Task name: " />
					<ice:outputText value="#{taskDetails.task.name}"
						rendered="#{not taskDetails.editMode}" />
					<ice:inputText value="#{taskDetails.task.name}"
						rendered="#{taskDetails.editMode}" />

					<ice:outputLabel value="Handler uri: " />
					<ice:outputText value="#{taskDetails.task.handlerUri}" />

					<ice:outputLabel value="Object ref: " />
					<ice:outputText value="#{taskDetails.task.objectRef}"
						rendered="#{not taskDetails.editMode}" />
					<ice:panelGrid rendered="#{taskDetails.editMode}">
						<ice:selectOneMenu id="objectRef"
							value="#{taskDetails.itemController.selectedResurceRef}"
							style="min-width: 157px; width: auto;" partialSubmit="true">
							<f:selectItems id="objectRefSelected"
								value="#{taskDetails.itemController.resourceRefList}" />
						</ice:selectOneMenu>
					</ice:panelGrid>
					<ice:outputLabel value="Last run start timestamp: " />
					<ice:outputText value="#{taskDetails.task.lastRunStartTimestamp}" />

					<ice:outputLabel value="Last run finish timestamp: " />
					<ice:outputText value="#{taskDetails.task.lastRunFinishTimestamp}" />

					<ice:outputLabel value="Execusion status" />
					<ice:outputText value="#{taskDetails.task.executionStatus}"
						rendered="#{not taskDetails.editMode}" />
					<ice:panelGrid rendered="#{taskDetails.editMode}">
						<ice:selectOneListbox id="executionStatus" partialSubmit="true"
							value="#{taskDetails.task.executionStatus}"
							style="min-width: 157px; width: auto;">
							<f:selectItems id="executionStatusSelected"
								value="#{taskDetails.itemController.executionStatus}" />
						</ice:selectOneListbox>
					</ice:panelGrid>

					<ice:outputLabel value="Exclusivity status" />
					<ice:outputText value="#{taskDetails.task.exclusivityStatus}"
						rendered="#{not taskDetails.editMode}" />
					<ice:panelGrid rendered="#{taskDetails.editMode}">
						<ice:selectOneListbox id="exclusivityStatus" partialSubmit="true"
							value="#{taskDetails.task.exclusivityStatus}"
							style="min-width: 157px; width: auto;">
							<f:selectItems id="exclusivityStatusSelected"
								value="#{taskDetails.itemController.exclusivityStatus}" />
						</ice:selectOneListbox>
					</ice:panelGrid>

					<ice:outputLabel value="Schedule interval" />
					<ice:outputText value="#{taskDetails.task.scheduleInterval}"
						rendered="#{not taskDetails.editMode}" />
					<ice:inputText id="scheduleInterval"
						rendered="#{taskDetails.editMode}"
						value="#{taskDetails.task.scheduleInterval}" />

				</ice:panelGrid>

			</ice:panelGroup>
			<div class="button-bar">

				<idm:button value="Create task instance"
					img="/resources/images/drive_burn.png" id="createTaskInstance"
					rendered="#{not taskDetails.editMode}" immediate="true"
					action="#{taskDetails.createInstance}" />
				<idm:button value="Delete task"
					img="/resources/images/drive_burn.png" id="deleteTask"
					rendered="#{not taskDetails.editMode}" immediate="true"
					action="#{taskList.deleteTask}" />
				<idm:button value="Release task"
					img="/resources/images/drive_burn.png" id="releaseTask"
					rendered="#{not taskDetails.editMode}" immediate="true"
					action="#{taskList.listFirst}" actionListener="#{taskDetails.releaseTask}"/>
					
				<idm:button value="Claim task"
					img="/resources/images/drive_burn.png" id="claimTask"
					rendered="#{not taskDetails.editMode}" immediate="true"
					action="#{taskList.listFirst}" actionListener="#{taskDetails.claimTask}" />
				<idm:button value="Save changes"
					img="/resources/images/drive_burn.png" id="saveChanges"
					rendered="#{taskDetails.editMode}" immediate="true"
					action="#{taskDetails.savePerformed}" />

			</div>
		</ice:form>
	</ui:define>
</ui:composition>