<?xml version="1.0" encoding="UTF-8" ?>
<ui:composition template="/resources/templates/template.xhtml" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:h="http://java.sun.com/jsf/html"
	xmlns:comp="http://java.sun.com/jsf/composite/components" xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ice="http://www.icesoft.com/icefaces/component"
	xmlns:idm="http://midpoint.evolveum.com/xml/ns/custom-taglib/">

	<ui:define name="title">#{msg['page.server.index.title']}</ui:define>

	<ui:define name="menu">
		<ui:include src="./menu.xhtml" />
	</ui:define>

	<ui:define name="content">
		<ice:form>
			<ui:remove>
				<ice:panelPopup modal="true" autoCentre="true" visible="#{resourceList.showPopup}">
					<f:facet name="header">
						<ice:outputText value="#{msg['Confirm delete']}" />
					</f:facet>
					<f:facet id="confirm" name="body">
						<ice:outputText value="#{msg['Delete selected resources?']}" />
						<div class="button-bar">
							<ice:commandButton id="deleteResourceYes" value="#{msg['Yes']}"
								action="#{resourceList.deleteResources}" />
							<ice:commandButton id="deleteResourceNo" value="#{msg['No']}"
								action="#{resourceList.hideConfirmDelete}" />
						</div>
					</f:facet>
				</ice:panelPopup>
			</ui:remove>

			<ice:dataTable id="taskTable" rows="50" value="#{taskList.objects}" var="item"
				columnClasses="iceDatTblCol1" rowClasses="iceDatTblRow1 iceDatTblRow2" columnWidths="250px, 230px, 220px"
				resizable="false">

				<ice:column>
					<f:facet name="header">
						<ice:commandSortHeader columnName="name" arrow="true" actionListener="#{taskList.sortList}">
							<ice:outputText id="nameTxt" value="Name" />
						</ice:commandSortHeader>
					</f:facet>
					<ice:outputText>
						<ice:commandLink styleClass="iceOutTxt" style="text-decoration: underline;" id="name"
							value="#{item.name}" action="#{taskList.showTaskDetails}">
							<f:param name="taskOid" value="#{item.oid}" />
						</ice:commandLink>
					</ice:outputText>
				</ice:column>
				<ice:column>
					<f:facet name="header">
						<ice:commandSortHeader columnName="type" arrow="true" actionListener="#{taskList.sortList}">
							<ice:outputText id="bundleTxt" value="Handler" />
						</ice:commandSortHeader>
					</f:facet>
					<ice:outputText value="#{item.handlerUri}" />
				</ice:column>
				<ice:column>
					<f:facet name="header">
						<ice:commandSortHeader columnName="version" arrow="true" actionListener="#{taskList.sortList}">
							<ice:outputText id="versionTxt" value="Object ref" />
						</ice:commandSortHeader>
					</f:facet>
					<ice:outputText value="#{item.objectRef}" />
				</ice:column>
			</ice:dataTable>

			<div class="button-bar">
				<idm:button value="Deactivate" img="/resources/images/link_break.png" id="deactivateServiceThreads"
					immediate="true" rendered="#{taskList.activated}" action="#{taskList.deactivate}" />
				<idm:button value="Reactivate" img="/resources/images/link_go.png" id="reactivateServiceThreads"
					immediate="true" rendered="#{not taskList.activated}" action="#{taskList.reactivate}" />
				<idm:button value="List running tasks" img="/resources/images/application_view_list.png" id="runningTasks"
					immediate="true" action="#{taskList.listRunningTasks}" />
				<idm:button value="List all tasks" img="/resources/images/application_view_list.png" id="allTasks"
					immediate="true" action="#{taskList.listFirst}" />
			</div>
		</ice:form>
	</ui:define>
</ui:composition>