<?xml version="1.0" encoding="UTF-8" ?>
<ui:composition template="/resources/templates/template.xhtml" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:h="http://java.sun.com/jsf/html"
	xmlns:comp="http://java.sun.com/jsf/composite/components" xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ice="http://www.icesoft.com/icefaces/component" xmlns:ace="http://www.icefaces.org/icefaces/components"
	xmlns:idm="http://midpoint.evolveum.com/xml/ns/custom-taglib/">

	<ui:define name="title">#{msg['page.config.logging.title']}</ui:define>

	<ui:define name="menu">
		<ui:include src="./menu.xhtml" />
	</ui:define>

	<ui:define name="content">
		<ice:form>
			<ice:outputLabel value="#{msg['page.config.logging.rootLogger']}" />
			<ice:selectOneMenu id="level" value="#{logging.rootLevelString}" style="margin-bottom: 20px;">
				<f:selectItems value="#{logging.levels}" />
			</ice:selectOneMenu>
			<ice:outputLabel value="#{msg['page.config.logging.rootAppender']}" />
			<ice:selectOneMenu value="#{logging.rootAppender}">
				<f:selectItems value="#{logging.appenderNames}" />
			</ice:selectOneMenu>
			<h3>#{msg['page.config.logging.subsystemLoggers']}</h3>
			<ice:dataTable rows="20" value="#{logging.subsystemLoggers}" var="item"
				columnWidths="auto, 70px, 280px, 150px" resizable="false">
				<ice:column>
					<f:facet name="header">
						<ice:selectBooleanCheckbox id="selectAllCheckbox" value="#{logging.selectAllSubsystemLoggers}"
							valueChangeListener="#{logging.selectAllSubsystemLoggersPerformed}" immediate="true"
							partialSubmit="true" />
					</f:facet>
					<ice:selectBooleanCheckbox id="selectCheckbox" value="#{item.selected}" partialSubmit="true"
						immediate="true" valueChangeListener="#{logging.selectSubsystemLoggerPerformed}" />
				</ice:column>
				<ice:column>
					<f:facet name="header">
						<ice:outputLabel value="#{msg['web.bean.basicLoggerListItem.level']}" />
					</f:facet>
					<ice:commandLink style="text-decoration: underline;" value="#{item.level}"
						action="#{loggerEdit.editSubsystemLogger}">
						<f:param name="loggerId" value="#{item.id}" />
					</ice:commandLink>
				</ice:column>
				<ice:column>
					<f:facet name="header">
						<ice:outputLabel value="#{msg['web.bean.subsystemLoggerListItem.component']}" />
					</f:facet>
					<ice:outputText value="#{item.componentString}" />
				</ice:column>
				<ice:column>
					<f:facet name="header">
						<ice:outputLabel value="#{msg['web.bean.basicLoggerListItem.appender']}" />
					</f:facet>
					<ice:panelGroup>
						<ui:repeat value="#{item.appenders}" var="app">
							<ice:outputText value="#{app}" />
						</ui:repeat>
					</ice:panelGroup>
				</ice:column>
			</ice:dataTable>
			<div class="button-bar" style="margin-bottom: 20px;">
				<idm:button value="#{msg['page.button.addSubsystem']}" buttonType="positive"
					action="#{logging.addSubsystemLogger}" img="/resources/images/report_add.png" />

				<idm:button value="#{msg['page.deleteSubsystem']}" buttonType="negative"
					action="#{logging.deleteSubsystemLoggers}" img="/resources/images/report_delete.png" />
			</div>

			<h3>#{msg['page.config.logging.loggers']}</h3>
			<ice:dataTable rows="20" value="#{logging.loggers}" var="item" columnWidths="auto, 70px, 280px, 150px"
				resizable="false">
				<ice:column>
					<f:facet name="header">
						<ice:selectBooleanCheckbox id="selectAllCheckbox" value="#{logging.selectAllLoggers}"
							valueChangeListener="#{logging.selectAllLoggersPerformed}" immediate="true" partialSubmit="true" />
					</f:facet>
					<ice:selectBooleanCheckbox id="selectCheckbox" value="#{item.selected}" partialSubmit="true"
						immediate="true" valueChangeListener="#{logging.selectLoggerPerformed}" />
				</ice:column>
				<ice:column>
					<f:facet name="header">
						<ice:outputLabel value="#{msg['web.bean.basicLoggerListItem.level']}" />
					</f:facet>
					<ice:commandLink style="text-decoration: underline;" value="#{item.level}"
						action="#{loggerEdit.editLogger}" rendered="#{not item.editing}">
						<f:param name="loggerId" value="#{item.id}" />
					</ice:commandLink>
					<ice:selectOneMenu value="#{item.levelString}" rendered="#{item.editing}">
						<f:selectItems value="#{logging.levels}" />
					</ice:selectOneMenu>
				</ice:column>
				<ice:column>
					<f:facet name="header">
						<ice:outputLabel value="#{msg['web.bean.loggerListItem.package']}" />
					</f:facet>
					<ice:outputText value="#{item.packageName}" rendered="#{not item.editing}" />
					<ice:inputText value="#{item.packageName}" rendered="#{item.editing}" style="width: inherit;" />
				</ice:column>
				<ice:column>
					<f:facet name="header">
						<ice:outputLabel value="#{msg['web.bean.basicLoggerListItem.appender']}" />
					</f:facet>
					<ice:panelGroup>
						<ui:repeat value="#{item.appenders}" var="app">
							<ice:outputText value="#{app}" />
							<ice:commandLink value="x" action="#{logging.deleteLoggerAppender}" immediate="true"
								partialSubmit="true" rendered="#{item.editing}" style="font-weight: bold;">
								<f:param name="appenderName" value="#{app}" />
								<f:param name="loggerId" value="#{item.id}" />
							</ice:commandLink>
						</ui:repeat>
					</ice:panelGroup>
					<ice:selectOneMenu valueChangeListener="#{logging.addLoggerAppender}" rendered="#{item.editing}"
						style="width: inherit;" partialSubmit="true" immediate="true">
						<f:param id="loggerId" name="loggerId" value="#{item.id}" />
						<f:selectItems value="#{logging.appenderNames}" />
					</ice:selectOneMenu>
				</ice:column>
			</ice:dataTable>
			<div class="button-bar" style="margin-bottom: 20px;">
				<idm:button value="#{msg['page.button.addLogger']}" buttonType="positive" action="#{logging.addLogger}"
					img="/resources/images/report_add.png" />

				<idm:button value="#{msg['page.button.deleteLogger']}" buttonType="negative"
					action="#{logging.deleteLoggers}" img="/resources/images/report_delete.png" />
			</div>

			<h3>#{msg['page.config.logging.appenders']}</h3>
			<ice:dataTable rows="20" value="#{logging.appenders}" var="item"
				columnWidths="auto, 90px, 370px, 120px, 120px, auto, auto, auto" resizable="false">
				<ice:column>
					<f:facet name="header">
						<ice:selectBooleanCheckbox id="selectAllCheckbox" value="#{logging.selectAllAppenders}"
							valueChangeListener="#{logging.selectAllAppendersPerformed}" immediate="true" partialSubmit="true" />
					</f:facet>
					<ice:selectBooleanCheckbox id="selectCheckbox" value="#{item.selected}" partialSubmit="true"
						immediate="true" valueChangeListener="#{logging.selectAppenderPerformed}" />
				</ice:column>
				<ice:column>
					<f:facet name="header">
						<ice:outputLabel value="#{msg['web.bean.appenderListItem.name']}" />
					</f:facet>
					<ui:remove>
						<ice:commandLink style="text-decoration: underline;" value="#{item.name}"
							action="#{appenderEdit.editAppender}">
							<f:param name="appenderName" value="#{item.name}" />
						</ice:commandLink>
					</ui:remove>
					<ice:commandLink style="text-decoration: underline;" value="#{item.name}"
						action="#{logging.editAppender}" rendered="#{not item.editing}">
						<f:param name="appenderName" value="#{item.name}" />
					</ice:commandLink>
					<ice:inputText value="#{item.name}" rendered="#{item.editing}" />
				</ice:column>
				<ice:column>
					<f:facet name="header">
						<ice:outputLabel value="#{msg['web.bean.appenderListItem.pattern']}" />
					</f:facet>
					<ice:outputText value="#{item.pattern}" rendered="#{not item.editing}" />
					<ice:inputText value="#{item.pattern}" rendered="#{item.editing}" style="width: inherit;" />
				</ice:column>
				<ice:column>
					<f:facet name="header">
						<ice:outputLabel value="#{msg['web.bean.appenderListItem.filePath']}" />
					</f:facet>
					<ice:outputText value="#{item.filePath}" rendered="#{not item.editing}" />
					<ice:inputText value="#{item.filePath}" rendered="#{item.editing}" style="width: inherit;" />
				</ice:column>
				<ice:column>
					<f:facet name="header">
						<ice:outputLabel value="#{msg['web.bean.appenderListItem.filePattern']}" />
					</f:facet>
					<ice:outputText value="#{item.filePattern}" rendered="#{not item.editing}" />
					<ice:inputText value="#{item.filePattern}" rendered="#{item.editing}" style="width: inherit;" />
				</ice:column>
				<ice:column>
					<f:facet name="header">
						<ice:outputLabel value="#{msg['web.bean.appenderListItem.maxHistory']}" />
					</f:facet>
					<ice:outputText value="#{item.maxHistory}" rendered="#{not item.editing}" />
					<ice:inputText value="#{item.maxHistory}" rendered="#{item.editing}" style="width: 25px;" />
				</ice:column>
				<ice:column>
					<f:facet name="header">
						<ice:outputLabel value="#{msg['web.bean.appenderListItem.maxFileSize']}" />
					</f:facet>
					<ice:outputText value="#{item.maxFileSize}" rendered="#{not item.editing}" />
					<ice:inputText value="#{item.maxFileSize}" rendered="#{item.editing}" style="width: 45px;" />
				</ice:column>
				<ice:column>
					<f:facet name="header">
						<ice:outputLabel value="#{msg['web.bean.appenderListItem.appending']}" />
					</f:facet>
					<ice:selectBooleanCheckbox value="#{item.appending}" disabled="#{not item.editing}" />
				</ice:column>
			</ice:dataTable>
			<div class="button-bar">
				<idm:button value="#{msg['page.button.addAppender']}" buttonType="positive"
					img="/resources/images/printer_add.png" action="#{logging.addAppender}" />
				<idm:button value="#{msg['page.button.deleteAppender']}" buttonType="negative"
					img="/resources/images/printer_delete.png" action="#{logging.deleteAppenders}" />
			</div>

			<div class="button-bar" style="margin-top: 20px;">
				<idm:button value="#{msg['page.button.save']}" buttonType="positive" action="#{logging.savePerformed}"
					img="/resources/images/disk.png" />

				<idm:button value="#{msg['page.button.cancel']}" buttonType="negative" action="#{logging.cancelPerformed}"
					img="/resources/images/door_in.png" />
			</div>
		</ice:form>
	</ui:define>
</ui:composition>



