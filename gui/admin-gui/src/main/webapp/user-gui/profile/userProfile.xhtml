<?xml version="1.0" encoding="UTF-8" ?>
<!-- Copyright (c) 2011 Evolveum                             -->
<!--                                                         -->
<!-- The contents of this file are subject to the terms      -->
<!-- of the Common Development and Distribution License      -->
<!-- (the License). You may not use this file except in      -->
<!-- compliance with the License.                            -->
<!--                                                         -->
<!-- You can obtain a copy of the License at                 -->
<!-- http://www.opensource.org/licenses/cddl1 or             -->
<!-- CDDLv1.0.txt file in the source code distribution.      -->
<!-- See the License for the specific language governing     -->
<!-- permission and limitations under the License.           -->
<!--                                                         -->
<!-- If applicable, add the following below the CDDL Header, -->
<!-- with the fields enclosed by brackets [] replaced by     -->
<!-- your own identifying information:                       -->
<!--                                                         -->
<!-- Portions Copyrighted 2011 [name of copyright owner]     -->
<!-- Portions Copyrighted 2011 Michal Serbak			     -->
<!--                                                         -->
<ui:composition template="/resources/templates/template_user.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:comp="http://java.sun.com/jsf/composite/components"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ice="http://www.icesoft.com/icefaces/component"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:idm="http://midpoint.evolveum.com/xml/ns/custom-taglib/">

	<ui:define name="title">Profile</ui:define>

	<ui:define name="menu">
		<div id="sidebarImage"></div>
	</ui:define>

	<ui:define name="content">
		<ice:form id="user-profile">
			<ice:panelGrid columns="2" cellpadding="7" cellspacing="7"
				id="userProfileGrid">

				<ice:outputText
					value="#{msg['page.account.detail.tab.user.givenName']}" />
				<ice:outputText id="givenName" value="#{userProfile.user.givenName}"
					rendered="#{!userProfile.editMode}" />
				<ice:inputText id="givenNameText"
					value="#{userProfile.user.givenName}"
					rendered="#{userProfile.editMode}" />

				<ice:outputText
					value="#{msg['page.account.detail.tab.user.familyName']}" />
				<ice:outputText id="familyName"
					value="#{userProfile.user.familyName}"
					rendered="#{!userProfile.editMode}" />
				<ice:inputText id="familyNameText"
					value="#{userProfile.user.familyName}"
					rendered="#{userProfile.editMode}" />

				<ice:outputText
					value="#{msg['page.account.detail.tab.user.fullName']}" />
				<ice:outputText id="fullName" value="#{userProfile.user.fullName}"
					rendered="#{!userProfile.editMode}" />
				<ice:inputText id="fullNameText"
					value="#{userProfile.user.fullName}"
					rendered="#{userProfile.editMode}" />

				<ice:outputText value="#{msg['page.account.detail.tab.user.name']}" />
				<ice:outputText id="name" value="#{userProfile.user.name}"
					rendered="#{!userProfile.editMode}" />
				<ice:inputText id="nameText" value="#{userProfile.user.name}"
					rendered="#{userProfile.editMode}" />

				<ice:outputLabel
					value="#{msg['page.account.detail.tab.user.email']}" />
				<ice:outputText id="email" rendered="#{!userProfile.editMode}"
					value="#{userProfile.user.email}" />
				<ice:inputText id="emailText" value="#{userProfile.user.email}"
					rendered="#{userProfile.editMode}" />

				<ice:outputLabel
					value="#{msg['page.account.detail.tab.user.locality']}" />
				<ice:outputText id="locality" rendered="#{!userProfile.editMode}"
					value="#{userProfile.user.locality}" />
				<ice:inputText id="localityText"
					value="#{userProfile.user.locality}"
					rendered="#{userProfile.editMode}" />
			</ice:panelGrid>

			<div class="button-bar">
				<idm:button action="#{userProfile.profileBackPerformed}"
					value="#{msg['page.account.detail.button.back']}"
					rendered="#{userProfile.editMode}" immediate="true"
					img="/resources/images/door_in.png" />

				<idm:button actionListener="#{userProfile.startEditMode}"
					value="#{msg['page.account.detail.button.edit']}" id="editButton"
					img="/resources/images/user_edit.png"
					rendered="#{!userProfile.editMode}" immediate="true"
					action="/profile/userProfile" />

				<idm:button action="#{userProfile.fillUser}"
					actionListener="#{userProfile.saveProfilePerformed}" id="saveButton"
					buttonType="positive"
					value="#{msg['page.account.detail.button.save']}"
					img="/resources/images/user.png" rendered="#{userProfile.editMode}" />
			</div>
		</ice:form>
		<br />
		<ice:form id="user-password">
			<ice:panelGrid columns="2" cellpadding="7" cellspacing="7"
				id="userPasswordGrid">

				<ice:outputLabel
					value="#{msg['page.account.detail.tab.user.password1']}"
					rendered="#{userProfile.editPasswordMode}" />
				<ice:panelGroup rendered="#{userProfile.editPasswordMode}">
					<ice:inputSecret id="password1"
						value="#{userProfile.user.password1}"
						requiredMessage="#{msg['field.required']}">
						<f:validator validatorId="PasswordValidator" />
						<f:attribute name="otherComponentId" value="password2" />
					</ice:inputSecret>
					<ice:message for="password1" errorClass="error" />
				</ice:panelGroup>

				<ice:outputLabel
					value="#{msg['page.account.detail.tab.user.password2']}"
					rendered="#{userProfile.editPasswordMode}" />
				<ice:panelGroup rendered="#{userProfile.editPasswordMode}">
					<ice:inputSecret id="password2" immediate="true"
						value="#{userProfile.user.password2}"
						requiredMessage="#{msg['field.required']}" />
					<ice:message for="password2" errorClass="error" />
				</ice:panelGroup>
			</ice:panelGrid>

			<div class="button-bar">
				<idm:button action="#{userProfile.passwordBackPerformed}"
					value="#{msg['page.account.detail.button.back']}"
					rendered="#{userProfile.editPasswordMode}" immediate="true"
					img="/resources/images/door_in.png" />
					
				<idm:button actionListener="#{userProfile.startEditPasswordMode}"
					value="Change password" id="editButton"
					img="/resources/images/user_edit.png"
					rendered="#{!userProfile.editPasswordMode}" immediate="true"
					action="/profile/userProfile" />

				<idm:button action="#{userProfile.fillUser}"
					actionListener="#{userProfile.savePasswordPerformed}"
					id="savePaswordButton" buttonType="positive" value="Change"
					img="/resources/images/user.png"
					rendered="#{userProfile.editPasswordMode}" />
			</div>


		</ice:form>

	</ui:define>
</ui:composition>