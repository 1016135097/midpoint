<?xml version="1.0" encoding="UTF-8"?>
<!-- Copyright (c) 2011 Evolveum							 -->
<!--														 -->
<!-- The contents of this file are subject to the terms		 -->
<!-- of the Common Development and Distribution License		 -->
<!-- (the License). You may not use this file except in		 -->
<!-- compliance with the License.							 -->
<!--														 -->
<!-- You can obtain a copy of the License at				 -->
<!-- http://www.opensource.org/licenses/cddl1 or			 -->
<!-- CDDLv1.0.txt file in the source code distribution.	 	 -->
<!-- See the License for the specific language governing	 -->
<!-- permission and limitations under the License.			 -->
<!--														 -->
<!-- If applicable, add the following below the CDDL Header, -->
<!-- with the fields enclosed by brackets [] replaced by	 -->
<!-- your own identifying information:						 -->
<!--														 -->
<!-- Portions Copyrighted 2011 [name of copyright owner]     -->
<!-- Portions Copyrighted 2011 Lazyman   					 -->
<!-- Portions Copyrighted 2011 Peter Prochazka               -->
<!--														 -->

<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:jee="http://www.springframework.org/schema/jee" xmlns:aop="http://www.springframework.org/schema/aop"
	xmlns:context="http://www.springframework.org/schema/context" xmlns:tx="http://www.springframework.org/schema/tx"
	xmlns:ws="http://jax-ws.dev.java.net/spring/core" xmlns:wss="http://jax-ws.dev.java.net/spring/servlet"
	xsi:schemaLocation="
     http://www.springframework.org/schema/jee
     http://www.springframework.org/schema/jee/spring-jee-3.0.xsd
     http://www.springframework.org/schema/beans
     http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
     http://www.springframework.org/schema/context
     http://www.springframework.org/schema/context/spring-context-3.0.xsd
     http://www.springframework.org/schema/tx
     http://www.springframework.org/schema/tx/spring-tx-3.0.xsd
     http://www.springframework.org/schema/aop
     http://www.springframework.org/schema/aop/spring-aop-3.0.xsd
     http://jax-ws.dev.java.net/spring/core
     http://jax-ws.dev.java.net/spring/core.xsd
     http://jax-ws.dev.java.net/spring/servlet
     http://jax-ws.dev.java.net/spring/servlet.xsd"
	default-lazy-init="false">

	<!-- Activates annotation-based bean configuration -->
	<context:annotation-config />
	<!-- needed is for @Configurable -->
	<!--context:spring-configured/ -->
	<!-- Scans for application @Components to deploy -->
	<context:component-scan base-package="com.evolveum.midpoint.web" />

<!-- override home directory setting  -->
	<bean id="applicationHomeSetup" class="com.evolveum.midpoint.init.test.FakeApplicationHomeSetup" init-method="init"
		scope="singleton" />

	<bean id="guiUserDtoManager" class="com.evolveum.midpoint.web.test.UserManagerImplMock" scope="singleton" />
	<bean id="guiResourceDtoManager" class="com.evolveum.midpoint.web.test.ResourceManagerImplMock" scope="singleton" />
	<bean id="guiAccountShadowDtoManager" class="com.evolveum.midpoint.web.test.AccountManagerImplMock" scope="singleton" />
	<bean id="guiRoleDtoManager" class="com.evolveum.midpoint.web.test.RoleManagerImplMock" scope="singleton" />
	<bean id="guiObjectManager" class="com.evolveum.midpoint.web.test.BasicObjectManagerImplMock" scope="singleton" />

	<bean id="objectTypeCatalog" class="com.evolveum.midpoint.web.model.impl.ObjectTypeCatalogImpl" scope="singleton">
		<property name="supportedObjectManagers">
			<map>
				<entry>
					<key>
						<value>com.evolveum.midpoint.xml.ns._public.common.common_1.UserType</value>
					</key>
					<ref bean="guiUserDtoManager" />
				</entry>
				<entry>
					<key>
						<value>com.evolveum.midpoint.xml.ns._public.common.common_1.ResourceType</value>
					</key>
					<ref bean="guiResourceDtoManager" />
				</entry>
				<entry>
					<key>
						<value>com.evolveum.midpoint.xml.ns._public.common.common_1.AccountShadowType</value>
					</key>
					<ref bean="guiAccountShadowDtoManager" />
				</entry>
				<entry>
					<key>
						<value>com.evolveum.midpoint.xml.ns._public.common.common_1.RoleType</value>
					</key>
					<ref bean="guiRoleDtoManager" />
				</entry>
				<entry>
					<key>
						<value>com.evolveum.midpoint.xml.ns._public.common.common_1.ObjectType</value>
					</key>
					<ref bean="guiObjectManager" />
				</entry>
			</map>
		</property>
	</bean>

	<bean class="org.springframework.beans.factory.config.CustomScopeConfigurer">
		<property name="scopes">
			<map>
				<entry key="session">
					<bean class="com.evolveum.midpoint.web.test.MockSessionScope" />
				</entry>
				<entry key="request">
					<bean class="com.evolveum.midpoint.web.test.MockRequestScope" />
				</entry>
			</map>
		</property>
	</bean>

	<bean name="modelWebService" class="com.evolveum.midpoint.web.test.MockFactory" factory-method="createModelPortType" />
	
	<bean name="modelController" class="com.evolveum.midpoint.web.test.MockFactory" factory-method="createModelService" />

	<!-- override loggingManager in tests and do not call it's init method, so we won't override logging configuration (for testing with production) -->
	<bean name="loggingManager" class="com.evolveum.midpoint.web.component.LoggingManager" depends-on="initialDataImport" />

</beans>
