<?xml version="1.0" encoding="UTF-8"?>
<!-- Copyright (c) 2011 Evolveum -->
<!-- -->
<!-- The contents of this file are subject to the terms -->
<!-- of the Common Development and Distribution License -->
<!-- (the License). You may not use this file except in -->
<!-- compliance with the License. -->
<!-- -->
<!-- You can obtain a copy of the License at -->
<!-- http://www.opensource.org/licenses/cddl1 or -->
<!-- CDDLv1.0.txt file in the source code distribution. -->
<!-- See the License for the specific language governing -->
<!-- permission and limitations under the License. -->
<!-- -->
<!-- If applicable, add the following below the CDDL Header, -->
<!-- with the fields enclosed by brackets [] replaced by -->
<!-- your own identifying information: -->
<!-- -->
<!-- Portions Copyrighted 2011 [name of copyright owner] -->
<!-- Portions Copyrighted 2010 Forgerock -->
<!-- -->
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:jee="http://www.springframework.org/schema/jee" xmlns:aop="http://www.springframework.org/schema/aop"
	xmlns:context="http://www.springframework.org/schema/context" xmlns:tx="http://www.springframework.org/schema/tx"
	xmlns:ws="http://jax-ws.dev.java.net/spring/core" xmlns:wss="http://jax-ws.dev.java.net/spring/servlet"
	xsi:schemaLocation="
     http://www.springframework.org/schema/jee
     http://www.springframework.org/schema/jee/spring-jee-3.0.xsd
     http://www.springframework.org/schema/beans
     http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
     http://www.springframework.org/schema/context
     http://www.springframework.org/schema/context/spring-context-3.0.xsd
     http://www.springframework.org/schema/tx
     http://www.springframework.org/schema/tx/spring-tx-3.0.xsd
     http://www.springframework.org/schema/aop
     http://www.springframework.org/schema/aop/spring-aop-3.0.xsd
     http://jax-ws.dev.java.net/spring/core
     http://jax-ws.dev.java.net/spring/core.xsd
     http://jax-ws.dev.java.net/spring/servlet
     http://jax-ws.dev.java.net/spring/servlet.xsd"
	default-lazy-init="false">

	<!-- Activates annotation-based bean configuration -->
	<context:annotation-config />
	<!-- needed is for @Configurable -->
	<!--context:spring-configured/ -->
	<!-- Scans for application @Components to deploy -->
	<context:component-scan base-package="com.evolveum.midpoint.web" />

	<bean id="objectTypeCatalog" class="com.evolveum.midpoint.web.model.impl.ObjectTypeCatalogImpl" scope="singleton">
		<property name="supportedObjectManagers">
			<map>
				<entry>
					<key>
						<value>com.evolveum.midpoint.xml.ns._public.common.common_1.UserType</value>
					</key>
					<bean id="guiUserDtoManager" class="com.evolveum.midpoint.web.test.UserTypeManagerMock" scope="singleton" />
				</entry>
				<entry>
					<key>
						<value>com.evolveum.midpoint.xml.ns._public.common.common_1.ResourceType</value>
					</key>
					<bean id="guiResourceDtoManager" class="com.evolveum.midpoint.web.test.ResourceTypeManagerMock" scope="singleton" />
				</entry>
				<entry>
					<key>
						<value>com.evolveum.midpoint.xml.ns._public.common.common_1.AccountShadowType</value>
					</key>
					<bean id="guiAccountShadowDtoManager" class="com.evolveum.midpoint.web.test.AccountShadowTypeManagerMock" scope="singleton" />
				</entry>
			</map>
		</property>
	</bean>

	<bean class="org.springframework.beans.factory.config.CustomScopeConfigurer">
		<property name="scopes">
			<map>
				<entry key="session">
					<bean class="com.evolveum.midpoint.web.test.MockSessionScope" />
				</entry>
				<entry key="request">
					<bean class="com.evolveum.midpoint.web.test.MockRequestScope" />
				</entry>
			</map>
		</property>
	</bean>

	<bean name="modelWebService" class="com.evolveum.midpoint.web.test.MockFactory" factory-method="createModelPortType" />
	<!-- <bean name="repositoryService" class="com.evolveum.midpoint.web.test.MockFactory" factory-method="createRepositoryService" 
		/> -->

	<bean name="xmlRepositoryServiceFactory" class="com.evolveum.midpoint.repo.xml.XmlRepositoryServiceFactory"
		init-method="init" destroy-method="destroy">
		<property name="runServer" value="true" />
		<!-- embedded is applicable only if runServer = true -->
		<property name="embedded" value="true" />
		<property name="shutdown" value="false" />
		<property name="dropDatabase" value="true" />
		<!-- initialDataPath - path containing xmls that should be loaded into DB -->
		<property name="initialDataPath" value="" />
		<!-- database name -->
		<property name="databaseName" value="midPoint-test" />
		<!-- client connection properties -->
		<property name="host" value="localhost" />
		<property name="port" value="1984" />
		<property name="username" value="admin" />
		<property name="password" value="admin" />
	</bean>

	<!-- scope=prototype is mandatory, because every xml repo service has to be connected with separated session to the basex 
		server -->
	<bean name="repositoryService" factory-bean="xmlRepositoryServiceFactory" factory-method="getRepositoryService"
		class="com.evolveum.midpoint.repo.xml.XmlRepositoryService" scope="prototype" depends-on="xmlRepositoryServiceFactory"></bean>

</beans>
