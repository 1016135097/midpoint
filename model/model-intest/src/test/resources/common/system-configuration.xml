<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<systemConfiguration oid="00000000-0000-0000-0000-000000000001" version="0" 
	xmlns="http://midpoint.evolveum.com/xml/ns/public/common/common-2a"
	xmlns:c="http://midpoint.evolveum.com/xml/ns/public/common/common-2a">
    <name>SystemConfiguration</name>
    <logging>
    	<rootLoggerAppender>File Appender</rootLoggerAppender>
    	<rootLoggerLevel>INFO</rootLoggerLevel>
        <classLogger>
	        <level>TRACE</level>
	        <package>com.evolveum.midpoint.common.LoggingConfigurationManager</package>
      	</classLogger>
        <c:classLogger>
            <c:level>TRACE</c:level>
            <c:package>com.evolveum.midpoint.notifications</c:package>
        </c:classLogger>
        <appender xsi:type="c:FileAppenderConfigurationType" name="File Appender" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
            <pattern>%date [%thread] %-5level \(%logger{46}\): %message%n</pattern>
            <fileName>target/test.log</fileName>
            <append>true</append>
        </appender>
    </logging>
    <notificationConfiguration>
        <dummyNotifier name="all"/>
        <accountPasswordNotifier>
            <recipientExpression>
                <value>recipient@evolveum.com</value>
            </recipientExpression>
            <transport>mail</transport>
            <transport>dummy:accountPasswords</transport>
            <transport>sms:default</transport>
        </accountPasswordNotifier>
        <userPasswordNotifier>
            <recipientExpression>
                <value>recipient@evolveum.com</value>
            </recipientExpression>
            <transport>mail</transport>
            <transport>dummy:userPasswords</transport>
            <transport>sms:default</transport>
        </userPasswordNotifier>
        <simpleAccountNotifier>
            <recipientExpression>
                <value>recipient@evolveum.com</value>
            </recipientExpression>
            <levelOfDetail>10</levelOfDetail>
            <transport>mail</transport>
            <transport>dummy:accountChanges</transport>
        </simpleAccountNotifier>
        <simpleUserNotifier>
            <recipientExpression>
                <value>recipient@evolveum.com</value>
            </recipientExpression>
            <levelOfDetail>10</levelOfDetail>
            <transport>mail</transport>
            <transport>dummy:userChanges</transport>
        </simpleUserNotifier>
        <dummyNotifier name="newAccountsViaExpression">
            <expressionFilter>
                <expression>
                    <description>Simple expression.</description>
                    <script>
                        <code>event.isAccountRelated() &amp;&amp; event.isAdd() &amp;&amp; event.isSuccess()</code>
                    </script>
                </expression>
            </expressionFilter>
        </dummyNotifier>
        <handlerChain name="new accounts with traditional filters, dummy and simpleAccount notifiers">
            <categoryFilter>
                <category>accountOperation</category>
            </categoryFilter>
            <operationFilter>
                <operation>add</operation>
            </operationFilter>
            <statusFilter>
                <status>success</status>
            </statusFilter>
            <dummyNotifier name="newAccounts"/>
            <simpleAccountNotifier name="newAccounts">
                <levelOfDetail>10</levelOfDetail>
                <transport>mail</transport>
                <transport>dummy:newAccounts</transport>
            </simpleAccountNotifier>
            <simpleAccountNotifier name="newAccountsExpressions">
                <recipientExpression>
                    <script>
                        <code>java.util.Arrays.asList("test1","test2")</code>
                    </script>
                </recipientExpression>
                <subjectExpression>
                    <script>
                        <code>"Changed account for " + requestee.getName().getOrig()</code>
                    </script>
                </subjectExpression>
                <bodyExpression>
                    <script>
                        <code>"Body: Changed account for " + requestee.getName().getOrig()</code>
                    </script>
                </bodyExpression>
                <levelOfDetail>10</levelOfDetail>
                <transport>dummy:newAccountsViaExpression</transport>
            </simpleAccountNotifier>
        </handlerChain>
        <mail>
            <redirectToFile>target/mail-notifications.log</redirectToFile>
        </mail>
        <sms name="default">
            <gateway>
                <url>
                    <script>
                        <code>"https://my-sms-gateway.com/send?number=" + to + "&amp;text=" + encodedMessageText</code>
                    </script>
                </url>
                <redirectToFile>target/sms-notifications.log</redirectToFile>
            </gateway>
        </sms>
    </notificationConfiguration>
</systemConfiguration>
