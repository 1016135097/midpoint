<!--
  ~ Copyright (c) 2010-2014 Evolveum
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->
<report xmlns="http://midpoint.evolveum.com/xml/ns/public/common/common-3"
        xmlns:c="http://midpoint.evolveum.com/xml/ns/public/common/common-3"
        xmlns:t="http://prism.evolveum.com/xml/ns/public/types-3"
        xmlns:xsd="http://www.w3.org/2001/XMLSchema"
		oid="USERROLE-3333-3333-TEST-10000000000"
        version="0">
	<name>
		<orig xmlns="http://prism.evolveum.com/xml/ns/public/types-3">User roles subreport</orig>
		<norm xmlns="http://prism.evolveum.com/xml/ns/public/types-3">User roles subreport</norm>
	</name>
	<description>User roles subreport for midpoint users.</description>
	<!-- flag if this report is "parent" report, used for gui -->
	<parent>false</parent>
	<template>PGphc3BlclJlcG9ydCANCgkJCXhtbG5zPSJodHRwOi8vamFzcGVycmVwb3J0cy5zb3VyY2Vmb3JnZS5uZXQvamFzcGVycmVwb3J0cyIgDQoJCQl4bWxuczp4c2k9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvWE1MU2NoZW1hLWluc3RhbmNlIiANCgkJCXhzaTpzY2hlbWFMb2NhdGlvbj0iaHR0cDovL2phc3BlcnJlcG9ydHMuc291cmNlZm9yZ2UubmV0L2phc3BlcnJlcG9ydHMgaHR0cDovL2phc3BlcnJlcG9ydHMuc291cmNlZm9yZ2UubmV0L3hzZC9qYXNwZXJyZXBvcnQueHNkIiANCgkJCW5hbWU9InJlcG9ydFVzZXJSb2xlcyIgDQoJCQljb2x1bW5Db3VudD0iMiIgDQoJCQlwYWdlV2lkdGg9IjExMCIgDQoJCQlwYWdlSGVpZ2h0PSIxOCIgDQoJCQl3aGVuTm9EYXRhVHlwZT0iQWxsU2VjdGlvbnNOb0RldGFpbCIgDQoJCQljb2x1bW5XaWR0aD0iNTQiIA0KCQkJY29sdW1uU3BhY2luZz0iMSIgDQoJCQlsZWZ0TWFyZ2luPSIwIiANCgkJCXJpZ2h0TWFyZ2luPSIwIiANCgkJCXRvcE1hcmdpbj0iMCIgDQoJCQlib3R0b21NYXJnaW49IjAiIA0KCQkJdXVpZD0iNjdlNDY1YzUtNDZlYS00MGQyLWJlYTAtNDY5YzZjZjM4OTM3Ij4NCgkJCTxwcm9wZXJ0eSBuYW1lPSJuZXQuc2YuamFzcGVycmVwb3J0cy5hd3QuaWdub3JlLm1pc3NpbmcuZm9udCIgdmFsdWU9InRydWUiLz4NCgkJCTxwcm9wZXJ0eSBuYW1lPSJuZXQuc2YuamFzcGVycmVwb3J0cy5leHBvcnQucGRmLmZvcmNlLmxpbmVicmVhay5wb2xpY3kiIHZhbHVlPSJ0cnVlIi8+DQoJCQk8c3R5bGUgZm9udE5hbWU9IkRlamFWdSBTYW5zIiBmb250U2l6ZT0iMTAiIGhBbGlnbj0iTGVmdCIgaXNEZWZhdWx0PSJ0cnVlIiBpc1BkZkVtYmVkZGVkPSJ0cnVlIiANCgkJCQkgICBuYW1lPSJCYXNlIiBwZGZFbmNvZGluZz0iSWRlbnRpdHktSCIgcGRmRm9udE5hbWU9IkRlamFWdVNhbnMudHRmIiB2QWxpZ249Ik1pZGRsZSI+DQoJCQk8L3N0eWxlPg0KCQkJPHN0eWxlIGlzQm9sZD0iZmFsc2UiIGlzRGVmYXVsdD0iZmFsc2UiIG5hbWU9IkRldGFpbCIgc3R5bGU9IkJhc2UiLz4NCgkJCTxwYXJhbWV0ZXIgbmFtZT0idXNlck9pZCIgY2xhc3M9ImphdmEubGFuZy5TdHJpbmciLz4NCgkJCTxwYXJhbWV0ZXIgbmFtZT0iaHFsUXVlcnlSb2xlcyIgY2xhc3M9ImphdmEubGFuZy5TdHJpbmciLz4NCgkJCTxxdWVyeVN0cmluZyBsYW5ndWFnZT0iaHFsIj48IVtDREFUQVskUCF7aHFsUXVlcnlSb2xlc31dXT48L3F1ZXJ5U3RyaW5nPg0KCQkJPGZpZWxkIG5hbWU9InJvbGVOYW1lIiBjbGFzcz0iamF2YS5sYW5nLlN0cmluZyIvPg0KCQkJPGRldGFpbD4NCgkJCQk8YmFuZCBoZWlnaHQ9IjE4IiBzcGxpdFR5cGU9IlN0cmV0Y2giPg0KCQkJCQk8ZnJhbWU+DQoJCQkJCQk8cmVwb3J0RWxlbWVudCB1dWlkPSIzZThmZGQ2ZC1hNmZmLTQ0MDctOWExZS01ZDZiNDcwNjMwMGEiIHBvc2l0aW9uVHlwZT0iRmxvYXQiIHN0eWxlPSJEZXRhaWwiIG1vZGU9Ik9wYXF1ZSIgeD0iMCIgeT0iMSIgd2lkdGg9IjEwMCIgaGVpZ2h0PSIxNyIvPg0KCQkJCQkJPGxpbmU+DQoJCQkJCQkJPHJlcG9ydEVsZW1lbnQgdXVpZD0iNDdmOTE4MDEtY2Y1Zi00YmVkLWIxOWMtY2EzOTMxY2JmOThkIiBwb3NpdGlvblR5cGU9IkZpeFJlbGF0aXZlVG9Ub3AiIG1vZGU9Ik9wYXF1ZSIgeD0iMCIgeT0iMCIgd2lkdGg9IjEwMCIgaGVpZ2h0PSIxIiBmb3JlY29sb3I9IiMzMzMzMzMiPg0KCQkJCQkJCQk8cHJpbnRXaGVuRXhwcmVzc2lvbj48IVtDREFUQVtuZXcgamF2YS5sYW5nLkJvb2xlYW4oKGludCkkVntSRVBPUlRfQ09VTlR9LmludFZhbHVlKCkhPTEpXV0+PC9wcmludFdoZW5FeHByZXNzaW9uPg0KCQkJCQkJCTwvcmVwb3J0RWxlbWVudD4NCgkJCQkJCQk8Z3JhcGhpY0VsZW1lbnQ+DQoJCQkJCQkJCTxwZW4gbGluZVdpZHRoPSIwLjUiIGxpbmVDb2xvcj0iIzk5OTk5OSIvPg0KCQkJCQkJCTwvZ3JhcGhpY0VsZW1lbnQ+DQoJCQkJCQk8L2xpbmU+DQoJCQkJCQk8dGV4dEZpZWxkIGlzU3RyZXRjaFdpdGhPdmVyZmxvdz0idHJ1ZSI+DQoJCQkJCQkJPHJlcG9ydEVsZW1lbnQgdXVpZD0iZWJhZWYxNmQtMjkwMy00MDI5LTlhNmItZDRkMjQ0NTU4YWU5IiBzdHlsZT0iRGV0YWlsIiB4PSIwIiB5PSIyIiB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEzIi8+DQoJCQkJCQkJPHRleHRFbGVtZW50IHZlcnRpY2FsQWxpZ25tZW50PSJNaWRkbGUiLz4NCgkJCQkJCQk8dGV4dEZpZWxkRXhwcmVzc2lvbj48IVtDREFUQVskRntyb2xlTmFtZX1dXT48L3RleHRGaWVsZEV4cHJlc3Npb24+DQoJCQkJCQk8L3RleHRGaWVsZD4NCgkJCQkJPC9mcmFtZT4NCgkJCQk8L2JhbmQ+DQoJCQk8L2RldGFpbD4NCgkJPC9qYXNwZXJSZXBvcnQ+</template>
	<orientation>landscape</orientation>
	<export>pdf</export>
	<!-- set to true if report needs hibernate session (e.g. hql query is used) -->
	<useHibernateSession>true</useHibernateSession>
	<field>
		<nameReport>roleName</nameReport>
		<nameHeader>Name</nameHeader>
		<itemPath>c:name</itemPath>
		<width>100</width>
		<classType>t:PolyStringType</classType>
	</field>
	<!-- configuration properties -->
	<configuration xmlns:r="http://midpoint.evolveum.com/xml/ns/public/report">
		<r:hqlQueryRoles>
			select r.name.orig as roleName 
			from RAssignment as a, RRole as r 
			where a.targetRef.type = 8 and a.targetRef.targetOid = r.oid and a.owner.oid = $P{userOid}
		</r:hqlQueryRoles>
	</configuration>
	<!-- report parameters configuration schema sample with different options -->
	<configurationSchema>
		<definition>
			<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema"
                    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                    xmlns:q="http://prism.evolveum.com/xml/ns/public/query-3"
                    xmlns:a="http://prism.evolveum.com/xml/ns/public/annotation-3"
                    xmlns:r="http://midpoint.evolveum.com/xml/ns/public/report"
                    elementFormDefault="qualified"
                    targetNamespace="http://midpoint.evolveum.com/xml/ns/public/report">

				<xsd:import namespace="http://midpoint.evolveum.com/xml/ns/public/common/common-3"/>
				<xsd:import namespace="http://prism.evolveum.com/xml/ns/public/annotation-3"/>
				<xsd:import namespace="http://prism.evolveum.com/xml/ns/public/query-3"/>

				<xsd:complexType name="ConfigurationType">
					<xsd:annotation>
						<xsd:appinfo>
							<a:container/>
						</xsd:appinfo>
					</xsd:annotation>
					<xsd:sequence>
						<!-- HQL query for jasper design (queryString element) -->
						<xsd:element name="hqlQueryRoles" type="xsd:string"/>
					</xsd:sequence>
				</xsd:complexType>
				<xsd:element name="configuration" type="r:ConfigurationType"/>
			</xsd:schema>
		</definition>
	</configurationSchema>
</report>