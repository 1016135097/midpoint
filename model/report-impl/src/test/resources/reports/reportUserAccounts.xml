<!--
  ~ Copyright (c) 2010-2014 Evolveum
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->
<report xmlns="http://midpoint.evolveum.com/xml/ns/public/common/common-3"
        xmlns:c="http://midpoint.evolveum.com/xml/ns/public/common/common-3"
        xmlns:t="http://prism.evolveum.com/xml/ns/public/types-3"
        xmlns:xsd="http://www.w3.org/2001/XMLSchema"
		oid="USERACCO-3333-3333-TEST-10000000000"
        version="0">
	<name>
		<orig xmlns="http://prism.evolveum.com/xml/ns/public/types-3">User accounts subreport</orig>
		<norm xmlns="http://prism.evolveum.com/xml/ns/public/types-3">User accounts subreport</norm>
	</name>
	<description>User accounts subreport for midpoint users.</description>
	<!-- flag if this report is "parent" report, used for gui -->
	<parent>false</parent>
	<template>PGphc3BlclJlcG9ydCANCgkJCXhtbG5zPSJodHRwOi8vamFzcGVycmVwb3J0cy5zb3VyY2Vmb3JnZS5uZXQvamFzcGVycmVwb3J0cyIgDQoJCQl4bWxuczp4c2k9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvWE1MU2NoZW1hLWluc3RhbmNlIiANCgkJCXhzaTpzY2hlbWFMb2NhdGlvbj0iaHR0cDovL2phc3BlcnJlcG9ydHMuc291cmNlZm9yZ2UubmV0L2phc3BlcnJlcG9ydHMgaHR0cDovL2phc3BlcnJlcG9ydHMuc291cmNlZm9yZ2UubmV0L3hzZC9qYXNwZXJyZXBvcnQueHNkIiANCgkJCW5hbWU9InJlcG9ydFVzZXJBY2NvdW50cyIgDQoJCQljb2x1bW5Db3VudD0iMiIgDQoJCQlwYWdlV2lkdGg9IjE4MCIgDQoJCQlwYWdlSGVpZ2h0PSIxOCIgDQoJCQl3aGVuTm9EYXRhVHlwZT0iQWxsU2VjdGlvbnNOb0RldGFpbCIgDQoJCQljb2x1bW5XaWR0aD0iODkiIA0KCQkJY29sdW1uU3BhY2luZz0iMSIgDQoJCQlsZWZ0TWFyZ2luPSIwIiANCgkJCXJpZ2h0TWFyZ2luPSIwIiANCgkJCXRvcE1hcmdpbj0iMCIgDQoJCQlib3R0b21NYXJnaW49IjAiIA0KCQkJdXVpZD0iNjdlNDY1YzUtNDZlYS00MGQyLWJlYTAtNDY5YzZjZjM4OTM3Ij4NCgkJCTxwcm9wZXJ0eSBuYW1lPSJuZXQuc2YuamFzcGVycmVwb3J0cy5hd3QuaWdub3JlLm1pc3NpbmcuZm9udCIgdmFsdWU9InRydWUiLz4NCgkJCTxwcm9wZXJ0eSBuYW1lPSJuZXQuc2YuamFzcGVycmVwb3J0cy5leHBvcnQucGRmLmZvcmNlLmxpbmVicmVhay5wb2xpY3kiIHZhbHVlPSJ0cnVlIi8+DQoJCQk8c3R5bGUgZm9udE5hbWU9IkRlamFWdSBTYW5zIiBmb250U2l6ZT0iMTAiIGhBbGlnbj0iTGVmdCIgaXNEZWZhdWx0PSJ0cnVlIiBpc1BkZkVtYmVkZGVkPSJ0cnVlIiANCgkJCQkgICBuYW1lPSJCYXNlIiBwZGZFbmNvZGluZz0iSWRlbnRpdHktSCIgcGRmRm9udE5hbWU9IkRlamFWdVNhbnMudHRmIiB2QWxpZ249Ik1pZGRsZSI+DQoJCQk8L3N0eWxlPg0KCQkJPHN0eWxlIGlzQm9sZD0iZmFsc2UiIGlzRGVmYXVsdD0iZmFsc2UiIG5hbWU9IkRldGFpbCIgc3R5bGU9IkJhc2UiLz4NCgkJCTxwYXJhbWV0ZXIgbmFtZT0idXNlck9pZCIgY2xhc3M9ImphdmEubGFuZy5TdHJpbmciLz4NCgkJCTxwYXJhbWV0ZXIgbmFtZT0iaHFsUXVlcnlBY2NvdW50cyIgY2xhc3M9ImphdmEubGFuZy5TdHJpbmciLz4NCgkJCTxxdWVyeVN0cmluZyBsYW5ndWFnZT0iaHFsIj48IVtDREFUQVskUCF7aHFsUXVlcnlBY2NvdW50c31dXT48L3F1ZXJ5U3RyaW5nPg0KCQkJPGZpZWxkIG5hbWU9ImFjY291bnROYW1lIiBjbGFzcz0iamF2YS5sYW5nLlN0cmluZyIvPg0KCQkJPGZpZWxkIG5hbWU9InJlc291cmNlTmFtZSIgY2xhc3M9ImphdmEubGFuZy5TdHJpbmciLz4NCgkJCTxkZXRhaWw+DQoJCQkJPGJhbmQgaGVpZ2h0PSIxOCIgc3BsaXRUeXBlPSJTdHJldGNoIj4NCgkJCQkJPGZyYW1lPg0KCQkJCQkJPHJlcG9ydEVsZW1lbnQgdXVpZD0iM2U4ZmRkNmQtYTZmZi00NDA3LTlhMWUtNWQ2YjQ3MDYzMDBhIiBwb3NpdGlvblR5cGU9IkZsb2F0IiBzdHlsZT0iRGV0YWlsIiBtb2RlPSJPcGFxdWUiIHg9IjAiIHk9IjEiIHdpZHRoPSIxODAiIGhlaWdodD0iMTciLz4NCgkJCQkJCTxsaW5lPg0KCQkJCQkJCTxyZXBvcnRFbGVtZW50IHV1aWQ9IjQ3ZjkxODAxLWNmNWYtNGJlZC1iMTljLWNhMzkzMWNiZjk4ZCIgcG9zaXRpb25UeXBlPSJGaXhSZWxhdGl2ZVRvVG9wIiB4PSIwIiB5PSIwIiB3aWR0aD0iMTgwIiBoZWlnaHQ9IjEiIGZvcmVjb2xvcj0iIzMzMzMzMyI+DQoJCQkJCQkJCTxwcmludFdoZW5FeHByZXNzaW9uPjwhW0NEQVRBW25ldyBqYXZhLmxhbmcuQm9vbGVhbigoaW50KSRWe1JFUE9SVF9DT1VOVH0uaW50VmFsdWUoKSE9MSldXT48L3ByaW50V2hlbkV4cHJlc3Npb24+DQoJCQkJCQkJPC9yZXBvcnRFbGVtZW50Pg0KCQkJCQkJCTxncmFwaGljRWxlbWVudD4NCgkJCQkJCQkJPHBlbiBsaW5lV2lkdGg9IjAuNSIgbGluZUNvbG9yPSIjOTk5OTk5Ii8+DQoJCQkJCQkJPC9ncmFwaGljRWxlbWVudD4NCgkJCQkJCTwvbGluZT4NCgkJCQkJCTx0ZXh0RmllbGQgaXNTdHJldGNoV2l0aE92ZXJmbG93PSJ0cnVlIj4NCgkJCQkJCQk8cmVwb3J0RWxlbWVudCB1dWlkPSJlYmFlZjE2ZC0yOTAzLTQwMjktOWE2Yi1kNGQyNDQ1NThhZTkiIHBvc2l0aW9uVHlwZT0iRmxvYXQiIHN0cmV0Y2hUeXBlPSJSZWxhdGl2ZVRvVGFsbGVzdE9iamVjdCIgc3R5bGU9IkRldGFpbCIgeD0iMCIgeT0iMiIgd2lkdGg9IjE4MCIgaGVpZ2h0PSIxMyIvPg0KCQkJCQkJCTx0ZXh0RWxlbWVudCB2ZXJ0aWNhbEFsaWdubWVudD0iTWlkZGxlIi8+IA0KCQkJCQkJCTx0ZXh0RmllbGRFeHByZXNzaW9uPjwhW0NEQVRBWyRGe3Jlc291cmNlTmFtZX0rICI6ICIgKyAkRnthY2NvdW50TmFtZX1dXT48L3RleHRGaWVsZEV4cHJlc3Npb24+DQoJCQkJCQk8L3RleHRGaWVsZD4NCgkJCQkJPC9mcmFtZT4NCgkJCQk8L2JhbmQ+DQoJCQk8L2RldGFpbD4NCgkJPC9qYXNwZXJSZXBvcnQ+</template>
	<orientation>landscape</orientation>
	<export>pdf</export>
	<!-- set to true if report needs hibernate session (e.g. hql query is used) -->
	<useHibernateSession>true</useHibernateSession>
	<field>
		<nameReport>accountName</nameReport>
		<nameHeader>Name</nameHeader>
		<itemPath>c:name</itemPath>
		<width>100</width>
		<classType>t:PolyStringType</classType>
	</field>
	<!-- configuration properties -->
	<configuration xmlns:r="http://midpoint.evolveum.com/xml/ns/public/report">
		<r:hqlQueryAccounts>
			select r.name.orig as resourceName, 
			s.name.orig as accountName 
			from RObjectReference as o, 
			RShadow as s, 
			RResource as r 
			where s.resourceRef.targetOid = r.oid and o.owner.oid = $P{userOid} and o.type = 7 and o.targetOid = s.oid and s.kind = 0 
			order by r.name.orig, s.name.orig
		</r:hqlQueryAccounts>
	</configuration>			
	<!-- report parameters configuration schema sample with different options -->
	<configurationSchema>
		<definition>
			<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema"
                    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                    xmlns:q="http://prism.evolveum.com/xml/ns/public/query-3"
                    xmlns:a="http://prism.evolveum.com/xml/ns/public/annotation-3"
                    xmlns:r="http://midpoint.evolveum.com/xml/ns/public/report"
                    elementFormDefault="qualified"
                    targetNamespace="http://midpoint.evolveum.com/xml/ns/public/report">

				<xsd:import namespace="http://midpoint.evolveum.com/xml/ns/public/common/common-3"/>
				<xsd:import namespace="http://prism.evolveum.com/xml/ns/public/annotation-3"/>
				<xsd:import namespace="http://prism.evolveum.com/xml/ns/public/query-3"/>

				<xsd:complexType name="ConfigurationType">
					<xsd:annotation>
						<xsd:appinfo>
							<a:container/>
						</xsd:appinfo>
					</xsd:annotation>
					<xsd:sequence>
						<!-- HQL query for jasper design (queryString element) -->
						<xsd:element name="hqlQueryAccounts" type="xsd:string"/>
					</xsd:sequence>
				</xsd:complexType>
				<xsd:element name="configuration" type="r:ConfigurationType"/>
			</xsd:schema>
		</definition>
	</configurationSchema>
</report>