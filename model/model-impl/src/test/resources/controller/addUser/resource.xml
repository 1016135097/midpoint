<?xml version="1.0" encoding="UTF-8"?>
<!-- Copyright (c) 2011 Evolveum                             -->
<!--                                                         -->
<!-- The contents of this file are subject to the terms      -->
<!-- of the Common Development and Distribution License      -->
<!-- (the License). You may not use this file except in      -->
<!-- compliance with the License.                            -->
<!--                                                         -->
<!-- You can obtain a copy of the License at                 -->
<!-- http://www.opensource.org/licenses/cddl1 or             -->
<!-- CDDLv1.0.txt file in the source code distribution.      -->
<!-- See the License for the specific language governing     -->
<!-- permission and limitations under the License.           -->
<!--                                                         -->
<!-- If applicable, add the following below the CDDL Header, -->
<!-- with the fields enclosed by brackets [] replaced by     -->
<!-- your own identifying information:                       -->
<!--                                                         -->
<!-- Portions Copyrighted 2011 [name of copyright owner]     -->
<!--                                                         -->  
<c:object xsi:type="c:ResourceType" oid="10000000-0000-0000-0000-000000000003" xmlns:c="http://midpoint.evolveum.com/xml/ns/public/common/common-1.xsd"
       xmlns:i="http://midpoint.evolveum.com/xml/ns/public/common/common-1.xsd"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:ri="http://midpoint.evolveum.com/xml/ns/public/resource/instances/10000000-0000-0000-0000-000000000003"
       xmlns:ids="http://midpoint.evolveum.com/xml/ns/public/resource/idconnector/resource-schema-1.xsd">
    <c:name>Localhost OpenDJ</c:name>
    <c:type>http://midpoint.evolveum.com/xml/ns/public/resource/idconnector/resourceaccessconfiguration-1.xsd</c:type>
    <c:namespace>http://midpoint.evolveum.com/xml/ns/public/resource/instances/10000000-0000-0000-0000-000000000003</c:namespace>
    <c:configuration>
        <idc:ConnectorConfiguration xmlns:idc="http://midpoint.evolveum.com/xml/ns/public/resource/idconnector/configuration-1.xsd"
                                    xmlns:iccldap="http://midpoint.evolveum.com/xml/ns/resource/idconnector/bundle/org.identityconnectors.ldap/org.identityconnectors.ldap.LdapConnector/1.0.5531">
            <idc:ConnectorRef bundleName="org.identityconnectors.ldap" bundleVersion="1.0.5754openidm" connectorName="org.identityconnectors.ldap.LdapConnector">
            </idc:ConnectorRef>
            <idc:BundleProperties>
                <iccldap:port>1389</iccldap:port>
                <iccldap:host>localhost</iccldap:host>
                <iccldap:baseContexts>dc=example,dc=com</iccldap:baseContexts>
                <iccldap:principal>cn=directory manager</iccldap:principal>
                <iccldap:credentials>secret</iccldap:credentials>
                <iccldap:usePagedResultControl>true</iccldap:usePagedResultControl>
            </idc:BundleProperties>
            <idc:PoolConfigOption minEvictTimeMillis="5000" minIdle="5" maxIdle="30" maxObjects="120" maxWait="5000"/>
            <idc:OperationTimeouts>
                <idc:OperationTimeout name="create" timeout="50000"/>
                <idc:OperationTimeout name="update" timeout="50000"/>
                <idc:OperationTimeout name="delete" timeout="50000"/>
                <idc:OperationTimeout name="test" timeout="50000"/>
                <idc:OperationTimeout name="scriptOnConnector" timeout="50000"/>
                <idc:OperationTimeout name="scriptOnResource" timeout="50000"/>
                <idc:OperationTimeout name="get" timeout="50000"/>
                <idc:OperationTimeout name="authenticate" timeout="50000"/>
                <idc:OperationTimeout name="search" timeout="50000"/>
                <idc:OperationTimeout name="validate" timeout="50000"/>
                <idc:OperationTimeout name="sync" timeout="50000"/>
                <idc:OperationTimeout name="schema" timeout="50000"/>
            </idc:OperationTimeouts>
        </idc:ConnectorConfiguration>
    </c:configuration>
    <c:schema>
        <xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema" 
                    targetNamespace="http://midpoint.evolveum.com/xml/ns/public/resource/instances/10000000-0000-0000-0000-000000000003"
                    elementFormDefault="qualified"
                    xmlns:c="http://midpoint.evolveum.com/xml/ns/public/common/common-1.xsd"
                    xmlns:r="http://midpoint.evolveum.com/xml/ns/public/resource/resource-schema-1.xsd"
                    xmlns:ri="http://midpoint.evolveum.com/xml/ns/public/resource/instances/10000000-0000-0000-0000-000000000003"
                    xmlns:ids="http://midpoint.evolveum.com/xml/ns/public/resource/idconnector/resource-schema-1.xsd">
            <xsd:import namespace="http://midpoint.evolveum.com/xml/ns/public/resource/idconnector/resource-schema-1.xsd"/>
            <xsd:import namespace="http://midpoint.evolveum.com/xml/ns/public/common/common-1.xsd"/>
            <xsd:import namespace="http://midpoint.evolveum.com/xml/ns/public/resource/resource-schema-1.xsd"/>

            <!-- Definition of Account object class -->
            <xsd:complexType name="Account">
                <xsd:annotation>
                    <xsd:appinfo>
                        <r:identifier ref="ids:__UID__"/>
                        <r:secondaryIdentifier ref="ids:__NAME__"/>
                        <r:displayName ref="ri:description"/>
                        <r:descriptionAttribute ref="ri:description"/>
                        <r:nativeObjectClass>__ACCOUNT__</r:nativeObjectClass>
                        <r:accountType default="true"/>
                    </xsd:appinfo>
                </xsd:annotation>
                <xsd:complexContent>
                    <xsd:extension base="r:ResourceObjectClass">
                        <xsd:sequence>
                            <xsd:element ref="ids:__NAME__">
                                <xsd:annotation>
                                    <xsd:appinfo>
                                        <r:nativeAttributeName>__NAME__</r:nativeAttributeName>
                                        <r:attributeDisplayName>DN</r:attributeDisplayName>
                                    </xsd:appinfo>
                                </xsd:annotation>
                            </xsd:element>
                            <xsd:element minOccurs="0" name="description" type="xsd:string">
                                <xsd:annotation>
                                    <xsd:appinfo>
                                        <r:help>DESCRIPTION_NAME_HELP_KEY</r:help>
                                        <r:nativeAttributeName>description</r:nativeAttributeName>
                                    </xsd:appinfo>
                                </xsd:annotation>
                            </xsd:element>
                            <xsd:element ref="ids:__PASSWORD__">
                                <xsd:annotation>
                                    <xsd:appinfo>
                                        <r:attributeFlag>PASSWORD</r:attributeFlag>
                                        <r:classifiedAttribute>
                                            <r:encryption>HASH</r:encryption>
                                            <r:classificationLevel>password</r:classificationLevel>
                                        </r:classifiedAttribute>
                                        <r:nativeAttributeName>__PASSWORD__</r:nativeAttributeName>
                                    </xsd:appinfo>
                                </xsd:annotation>
                            </xsd:element>
                            <xsd:element name="sn" type="xsd:string">
                                <xsd:annotation>
                                    <xsd:appinfo>
                                        <r:nativeAttributeName>sn</r:nativeAttributeName>
                                    </xsd:appinfo>
                                </xsd:annotation>
                            </xsd:element>
                            <xsd:element name="cn" type="xsd:string">
                                <xsd:annotation>
                                    <xsd:appinfo>
                                        <r:nativeAttributeName>cn</r:nativeAttributeName>
                                    </xsd:appinfo>
                                </xsd:annotation>
                            </xsd:element>
                            <xsd:element ref="ids:__UID__" minOccurs="0">
                                <xsd:annotation>
                                    <xsd:appinfo>
                                        <r:attributeFlag>NOT_UPDATEABLE</r:attributeFlag>
                                        <r:nativeAttributeName>__UID__</r:nativeAttributeName>
                                    </xsd:appinfo>
                                </xsd:annotation>
                            </xsd:element>
                            <xsd:element minOccurs="0" name="givenName" type="xsd:string">
                                <xsd:annotation>
                                    <xsd:appinfo>
                                        <r:nativeAttributeName>givenName</r:nativeAttributeName>
                                    </xsd:appinfo>
                                </xsd:annotation>
                            </xsd:element>
                        </xsd:sequence>
                    </xsd:extension>
                </xsd:complexContent>
            </xsd:complexType>
            <xsd:complexType name="Group">
                <xsd:annotation>
                    <xsd:appinfo>
                        <r:identifier ref="ids:__UID__"/>
                        <r:secondaryIdentifier ref="ids:__NAME__"/>
                        <r:displayName ref="ri:description"/>
                        <r:descriptionAttribute ref="ri:description"/>
                        <r:nativeObjectClass>__GROUP__</r:nativeObjectClass>
                        <r:container/>
                    </xsd:appinfo>
                </xsd:annotation>
                <xsd:complexContent>
                    <xsd:extension base="r:ResourceObjectClass">
                        <xsd:sequence>
                            <xsd:element ref="ids:__NAME__">
                                <xsd:annotation>
                                    <xsd:appinfo>
                                        <r:nativeAttributeName>__NAME__</r:nativeAttributeName>
                                    </xsd:appinfo>
                                </xsd:annotation>
                            </xsd:element>
                            <xsd:element minOccurs="0" name="description" type="xsd:string">
                                <xsd:annotation>
                                    <xsd:appinfo>
                                        <r:help>DESCRIPTION_NAME_HELP_KEY</r:help>
                                        <r:nativeAttributeName>description</r:nativeAttributeName>
                                    </xsd:appinfo>
                                </xsd:annotation>
                            </xsd:element>
                            <xsd:element ref="ids:__UID__">
                                <xsd:annotation>
                                    <xsd:appinfo>
                                        <r:attributeFlag>NOT_UPDATEABLE</r:attributeFlag>
                                        <r:nativeAttributeName>__UID__</r:nativeAttributeName>
                                    </xsd:appinfo>
                                </xsd:annotation>
                            </xsd:element>
                        </xsd:sequence>
                    </xsd:extension>
                </xsd:complexContent>
            </xsd:complexType>
        </xsd:schema>
    </c:schema>
    <c:schemaHandling>
        <c:accountType default="true">
            <c:name>Default Account</c:name>
            <i:objectClass>ri:Account</i:objectClass>
            <i:attribute ref="ids:__NAME__">
                <c:name>Distinguished Name</c:name>
                <c:access>create</c:access>
                <c:access>read</c:access>
                <i:outbound default="true">
                    <i:valueExpression>
                        declare namespace i="http://midpoint.evolveum.com/xml/ns/public/common/common-1.xsd";
                        concat('uid=', $i:user/c:name, ',ou=people,dc=example,dc=com')
                        </i:valueExpression>
                </i:outbound>                    
            </i:attribute>
            <i:attribute ref="ids:__UID__">
                <c:name>Entry UUID</c:name>
                <c:access>read</c:access>
            </i:attribute>
            <i:attribute ref="ri:cn">
                <c:name>Common Name</c:name>
                <c:access>create</c:access>
                <c:access>read</c:access>
                <c:access>update</c:access>
                <i:outbound>
                    <i:valueExpression>
                        declare namespace i="http://midpoint.evolveum.com/xml/ns/public/common/common-1.xsd";
                        $i:user/i:fullName
                    </i:valueExpression>
                </i:outbound>
            </i:attribute>
            <i:attribute ref="ri:sn">
                <c:name>Surname</c:name>
                <c:access>create</c:access>
                <c:access>read</c:access>
                <c:access>update</c:access>
                <i:outbound>
                    <i:valueExpression>
                        declare namespace i="http://midpoint.evolveum.com/xml/ns/public/common/common-1.xsd";
                        $i:user/i:familyName
                    </i:valueExpression>
                </i:outbound>
            </i:attribute>
            <i:attribute ref="ri:givenName">
                <c:name>Given Name</c:name>
                <c:access>create</c:access>
                <c:access>read</c:access>
                <c:access>update</c:access>
                <i:outbound>
                    <i:valueExpression>
                        declare namespace i="http://midpoint.evolveum.com/xml/ns/public/common/common-1.xsd";
                        $i:user/i:givenName
                    </i:valueExpression>
                </i:outbound>
            </i:attribute>
            <i:attribute ref="ri:description">
                <i:outbound default="true">
                    <i:value>Created by IDM</i:value>
                </i:outbound>                    
            </i:attribute>
        </c:accountType>
    </c:schemaHandling>
</c:object>